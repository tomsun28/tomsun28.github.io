---
layout: post
title:  Log4j.xml配置 
date: 2018-01-04
tag: java
---

## Log4j.xml配置   

**日志配置文件,这里记一下**  


````

<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/" debug="false">

	<!-- 输出日志到控制台  ConsoleAppender -->
	<appender name="ConsoleAppender" class="org.apache.log4j.ConsoleAppender">
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="[%d][%p, (%F:%L).%M] %m%n" />
		</layout>
		<!--<filter class="org.apache.log4j.varia.LevelRangeFilter">-->
		<!--<param name="LevelMin" value="debug" />-->
		<!--<param name="LevelMax" value="info" />-->
		<!--<param name="AcceptOnMatch" value="false" />-->
		<!--</filter>-->
	</appender>

	<!-- 输出日志到文件  每天一个文件 -->
	<!--输出每天的运行日志到文件SystemOut.log-->
	<appender name="SystemOutFileAppender" class="org.apache.log4j.DailyRollingFileAppender">
		<!--Threshold为此级别及以上才会被输出！-->
		<param name="Threshold" value="info"/>
		<param name="Append" value="true" />
		<param name="ImmediateFlush" value="true"/>
		<param name="File" value="src/main/log/SystemOut.log"/>
		<param name="DatePattern" value="'.'yyyy-MM-dd'.log'"/>
		<param name="encoding" value="utf-8"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="[%d][%p, (%F:%L).%M] %m%n" />
		</layout>
	</appender>

	<!-- 输出日志到文件  文件大小到达指定尺寸的时候文件会自动回滚 -->
	<!-- 输出异常错误日志到文件ErrOut.log -->
	<appender name="ErrOutFileAppender" class="org.apache.log4j.RollingFileAppender">
		<param name="File" value="src/main/log/ErrOut.log"/>
		<param name="ImmediateFlush" value="true"/>
		<param name="Threshold" value="error"/>
		<param name="Append" value="true"/>
		<param name="MaxFileSize" value="30KB"/>
		<param name="MaxBackupIndex" value="100"/>
		<param name="encoding" value="utf-8"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="[%d][%p, (%F:%L).%M] %m%n" />
		</layout>
	</appender>

	<!-- 输出日志到文件  文件大小到达指定尺寸的时候文件会自动回滚 -->
	<!-- 输出运行的SQL语句日志到文件SqlOut.log -->
	<appender name="SqlOutFileAppender" class="org.apache.log4j.RollingFileAppender">
		<param name="File" value="src/main/log/SqlOut.log"/>
		<param name="ImmediateFlush" value="true"/>
		<param name="Threshold" value="error"/>
		<param name="Append" value="true"/>
		<param name="MaxFileSize" value="30KB"/>
		<param name="MaxBackupIndex" value="100"/>
		<param name="encoding" value="utf-8"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="[%d][%p, (%F:%L).%M] %m%n" />
		</layout>
	</appender>

	<!--固定文件,未使用-->
	<appender name="FileAppender" class="org.apache.log4j.FileAppender">
		<param name="File" value="src/main/log/xx.log" />
		<param name="Append" value="true" />
		<!--Threshold为此级别及以上才会被输出！-->
		<param name="Threshold" value="trace" />
		<param name="encoding" value="utf-8"/>
		<layout class="org.apache.log4j.PatternLayout">
			<param name="ConversionPattern" value="[%d][%p, (%F:%L).%M] %m%n" />
		</layout>
	</appender>

	<!--这个logger的设置是：举例在org.springframework包下面的所有输出日志必须级别level在info及以上级别才会被输出！-->
	<!--这样可以避免输出一些spring框架的许多常见debug信息!-->
	<logger name="org.springframework">
		<level value="info" />
	</logger>

	<logger name="org.json">
		<level value="ERROR" />
	</logger>
	<logger name="io.netty">
		<level value="info" />
	</logger>
	<logger name="org.quartz">
		<level value="ERROR" />
	</logger>
	<logger name="org.apache.commons">
		<level value="ERROR" />
	</logger>
	<logger name="test.java">
		<level value="error" />
	</logger>
	<logger name="org.slf4j" >
		<level value="info"/>
	</logger>
	<logger name="org.apache.log4j">
		<level value="info"/>
	</logger>

	<!-- 下面是打印 mybatis sql语句日志的配置 -->
	<logger name="com.how2java.tmall.mapper">
		<level value="TRACE"/>
		<appender-ref ref="SqlOutFileAppender"/>
	</logger>


	<!--level 为限制输出的级别，即此级别及以上的日志才会对应的输出！-->
	<root>
		<level value="trace" />
		<appender-ref ref="ConsoleAppender" />
		<appender-ref ref="SystemOutFileAppender" />
		<appender-ref ref="ErrOutFileAppender" />
	</root>
</log4j:configuration>


````
<br>
**日志开启**  

````
在web.xml配置:

<!-- log4j -->
    <context-param>
        <param-name>log4jConfigLocation</param-name>
        <param-value>classpath:log4j-server.xml</param-value>
    </context-param>
    <context-param>
        <param-name>log4jRefreshInterval</param-name>
        <param-value>3000</param-value>
    </context-param>
    <!-- 先开启log4j再去启动spring等 -->
    <listener>
        <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
    </listener>

或在项目启动时开启:

DOMConfigurator.configureAndWatch("src/config/log4j.xml");


````

<br>
<br>
<br>

*转载请注明* [from tomsun28](http://usthe.com)
````

````

````

````